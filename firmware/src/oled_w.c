#include "oled_w.h"
#include "definitions.h"
#include "string.h"

// *****************************************************************************
// *****************************************************************************
// Section: Global Data Definitions
// *****************************************************************************
// *****************************************************************************
// 6x8 font
const uint8_t font[] = {
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x5F,0x00,0x00,0x00,0x07,0x00,0x07,0x00, //	'sp,!,"
    0x14,0x7F,0x14,0x7F,0x14, // #
    0x24,0x2A,0x7F,0x2A,0x12,0x23,0x13,0x08,0x64,0x62,0x36,0x49,0x56,0x20,0x50, //	'$,%,&
    0x00,0x08,0x07,0x03,0x00,0x00,0x1C,0x22,0x41,0x00,0x00,0x41,0x22,0x1C,0x00, //	'',(,)
    0x2A,0x1C,0x7F,0x1C,0x2A,0x08,0x08,0x3E,0x08,0x08,0x00,0x00,0x70,0x30,0x00, //	'*,+,,
    0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x60,0x60,0x00,0x20,0x10,0x08,0x04,0x02, //	'-,.,/
    0x3E,0x51,0x49,0x45,0x3E,0x00,0x42,0x7F,0x40,0x00,0x72,0x49,0x49,0x49,0x46, //	'0,1,2
    0x21,0x41,0x49,0x4D,0x33,0x18,0x14,0x12,0x7F,0x10,0x27,0x45,0x45,0x45,0x39, //	'3,4,5
    0x3C,0x4A,0x49,0x49,0x31,0x41,0x21,0x11,0x09,0x07,0x36,0x49,0x49,0x49,0x36, //	'6,7,8
    0x46,0x49,0x49,0x29,0x1E,0x00,0x00,0x14,0x00,0x00,0x00,0x40,0x34,0x00,0x00, //	'9,:,;
    0x00,0x08,0x14,0x22,0x41,0x14,0x14,0x14,0x14,0x14,0x00,0x41,0x22,0x14,0x08, //	'<,=,>
    0x02,0x01,0x59,0x09,0x06,0x3E,0x41,0x5D,0x59,0x4E,                          //  '?,@
    0x7C,0x12,0x11,0x12,0x7C,                                                   //	'A
    0x7F,0x49,0x49,0x49,0x36,0x3E,0x41,0x41,0x41,0x22,0x7F,0x41,0x41,0x41,0x3E, //	'B,C,D
    0x7F,0x49,0x49,0x49,0x41,0x7F,0x09,0x09,0x09,0x01,0x3E,0x41,0x41,0x51,0x73, //	'E,F,G
    0x7F,0x08,0x08,0x08,0x7F,0x00,0x41,0x7F,0x41,0x00,0x20,0x40,0x41,0x3F,0x01, //	'H,I,J
    0x7F,0x08,0x14,0x22,0x41,0x7F,0x40,0x40,0x40,0x40,0x7F,0x02,0x1C,0x02,0x7F, //	'K,L,M
    0x7F,0x04,0x08,0x10,0x7F,0x3E,0x41,0x41,0x41,0x3E,0x7F,0x09,0x09,0x09,0x06, //	'N,O,P
    0x3E,0x41,0x51,0x21,0x5E,0x7F,0x09,0x19,0x29,0x46,0x26,0x49,0x49,0x49,0x32, //	'Q,R,S
    0x03,0x01,0x7F,0x01,0x03,0x3F,0x40,0x40,0x40,0x3F,0x1F,0x20,0x40,0x20,0x1F, //	'T,U,V
    0x3F,0x40,0x38,0x40,0x3F,0x63,0x14,0x08,0x14,0x63,0x03,0x04,0x78,0x04,0x03, //	'W,X,Y
    0x61,0x59,0x49,0x4D,0x43,                                                   //  'Z
    0x00,0x7F,0x41,0x41,0x41,0x02,0x04,0x08,0x10,0x20,                          /*	'[,\ */
    0x00,0x41,0x41,0x41,0x7F,0x04,0x02,0x01,0x02,0x04,0x40,0x40,0x40,0x40,0x40, //	'],^,_
    0x00,0x03,0x07,0x08,0x00,0x20,0x54,0x54,0x38,0x40,0x7F,0x28,0x44,0x44,0x38, //	'`,a,b
    0x38,0x44,0x44,0x44,0x28,0x38,0x44,0x44,0x28,0x7F,0x38,0x54,0x54,0x54,0x18, //	'c,d,e
    0x00,0x08,0x7E,0x09,0x02,0x0C,0x52,0x52,0x4A,0x3C,0x7F,0x08,0x04,0x04,0x78, //	'f,g,h
    0x00,0x44,0x7D,0x40,0x00,0x20,0x40,0x40,0x3D,0x00,0x7F,0x10,0x28,0x44,0x00, //	'i,j,k
    0x00,0x41,0x7F,0x40,0x00,0x7C,0x04,0x78,0x04,0x78,0x7C,0x08,0x04,0x04,0x78, //	'l,m,n
    0x38,0x44,0x44,0x44,0x38,0x7C,0x18,0x24,0x24,0x18,0x18,0x24,0x24,0x18,0x7C, //	'o,p,q
    0x7C,0x08,0x04,0x04,0x08,0x48,0x54,0x54,0x54,0x24,0x04,0x04,0x3F,0x44,0x24, //	'r,s,t
    0x3C,0x40,0x40,0x20,0x7C,0x1C,0x20,0x40,0x20,0x1C,0x3C,0x40,0x30,0x40,0x3C, //	'u,v,w
    0x44,0x28,0x10,0x28,0x44,0x4C,0x50,0x50,0x50,0x3C,0x44,0x64,0x54,0x4C,0x44, //	'x,y,z
    0x00,0x08,0x36,0x41,0x00,0x00,0x00,0x77,0x00,0x00,0x00,0x41,0x36,0x08,0x00, //	'{,|,}
    0x02,0x01,0x02,0x04,0x02                                                    //  '~
} ;

const uint8_t microchip_logo[] = {
0xFF, 0x03, 0x03, 0x03, 0x03, 0x03, 0x83, 0xC3, 0xC3, 0xE3, 0xE3, 0xE3, 0xF3, 0xF3, 0xF3, 0xF3,
0xF3, 0xE3, 0xE3, 0xE3, 0x83, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x83, 0x03,
0x03, 0x03, 0x03, 0x03, 0x03, 0x83, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0xFF,
0xFF, 0x00, 0x00, 0x00, 0xF0, 0x7E, 0x1F, 0x0F, 0x3F, 0x61, 0xC0, 0x00, 0x01, 0x07, 0x0F, 0x1F,
0x73, 0xC0, 0x00, 0x00, 0x03, 0x07, 0x0C, 0x70, 0xE0, 0x80, 0x00, 0x00, 0x80, 0xFF, 0xFF, 0x0F,
0x7E, 0xF0, 0xE0, 0xF8, 0x1F, 0x0F, 0xFF, 0xF0, 0x00, 0xFC, 0xFC, 0x00, 0xFC, 0x0C, 0x0C, 0x0C,
0x0C, 0x08, 0x00, 0xFC, 0xFC, 0xCC, 0xCC, 0xCC, 0xEC, 0xFC, 0x00, 0xF8, 0xFC, 0x0C, 0x0C, 0x0C,
0x0C, 0xFC, 0xF8, 0x00, 0xFC, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x00, 0xFC, 0xFC, 0x60, 0x60, 0x60,
0xFC, 0xFC, 0x00, 0xFC, 0xFC, 0x00, 0xFC, 0xFC, 0xCC, 0xCC, 0xCC, 0xFC, 0x78, 0x00, 0x00, 0xFF,
0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x38, 0x7E, 0x7F, 0xFF, 0xFC, 0xF8, 0xE0, 0xE0,
0xF8, 0xFF, 0x7F, 0x7E, 0x38, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x00, 0x00,
0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x03, 0x03, 0x00, 0x03, 0x03, 0x00, 0x01, 0x03, 0x03, 0x03,
0x03, 0x01, 0x00, 0x03, 0x03, 0x00, 0x00, 0x00, 0x01, 0x03, 0x00, 0x00, 0x01, 0x03, 0x03, 0x03,
0x03, 0x01, 0x01, 0x00, 0x01, 0x03, 0x03, 0x03, 0x03, 0x03, 0x00, 0x03, 0x03, 0x00, 0x00, 0x00,
0x03, 0x03, 0x00, 0x01, 0x03, 0x00, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF,
0xFF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF,
0xFF, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80,
0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xFF
};

const uint8_t SSD1306_Initial_Table[] =
{
	SSD1306_CMD_SET_DISPLAY_OFF,                // 0xAE DISPLAY OFF
	SSD1306_CMD_SET_DISPLAY_CLOCK_DIVIDE_RATIO, // 0xD5 SET OSC FREQUENY
	0x80,                                       // divide ratio = 1 (bit 3-0), OSC (bit 7-4)
	SSD1306_CMD_SET_MULTIPLEX_RATIO,            // 0xA8 SET MUX RATIO
	39,                                         // 1/39 duty
    SSD1306_CMD_SET_SEGMENT_RE_MAP_COL127_SEG0, // 0xA1 set segment re-map, column address 127 is mapped to SEG0
    SSD1306_CMD_SET_COM_OUTPUT_SCAN_DOWN,       // 0xC8 set COM/Output scan direction, re-mapped mode (COM[N-1] to COM0)
    SSD1306_CMD_SET_DISPLAY_START_LINE(0x00),   // 0x40 set display start line, start line = 0
	SSD1306_CMD_SET_DISPLAY_OFFSET,             // 0xD3 SET DISPLAY OFFSET
	0x00,                                       // offset = 0
    SSD1306_CMD_SET_CHARGE_PUMP_SETTING,        // 0x8D ENABLE CHARGE PUMP REGULATOR
	0x14,                                       // Enable Charge Pump
	SSD1306_CMD_SET_COM_PINS,                   // 0xDA SET COM PINS HARDWARE CONFIGURATION    
	0x12,                                       // alternative COM pin configuration    
	SSD1306_CMD_SET_CONTRAST_CONTROL_FOR_BANK0, // 0x81 SET CONTRAST CONTROL    
    0xAF,                                       //
    SSD1306_CMD_SET_PRE_CHARGE_PERIOD,          // 0xD9 SET PRE CHARGE PERIOD
    0x25,                                         //
    SSD1306_CMD_SET_VCOMH_DESELECT_LEVEL,       // 0xDB SET V_COMH DESELECT LEVEL
    0x20,                                       //
    SSD1306_CMD_ENTIRE_DISPLAY_AND_GDDRAM_ON,   // 0xA4 DISABLE ENTIRE DISPLAY ON
    SSD1306_CMD_SET_NORMAL_DISPLAY,             // 0xA6 NORMAL MODE (A7 for inverse display)
    SSD1306_CMD_SET_DISPLAY_ON                  // 0xAF DISPLAY ON    
 } ;

volatile bool isSPITransferDone ;
volatile bool isSPIDeassertCSline ;

void SPIEventHandler(uintptr_t context)
{
    isSPITransferDone = true ;
    /* De-assert the CS line */
    if (isSPIDeassertCSline)
        OLED_CS_Set() ;
}

// *****************************************************************************
// *****************************************************************************
// Section: Application Local Functions
// *****************************************************************************
// *****************************************************************************


/* TODO:  Add any necessary local functions.
*/

void OLED_Delay(void)
{
    uint32_t delay = 100000 ;
    while (delay > 0)
    {
        delay-- ;
        Nop() ;
    }
}    

void OLED_Reset(void)
{
//    OLED_RST_Clear() ;    // shared with QT7 YLINE5 Driven Shield
    OLED_Delay() ;
//    OLED_RST_Set() ;      // shared with QT7 YLINE
    OLED_Delay() ;
}

void OLED_Init(void)
{
    isSPIDeassertCSline = true ;    
    SPI2_CallbackRegister(SPIEventHandler, (uintptr_t)NULL) ;
    OLED_DC_Clear() ;   // DC=0, command
    OLED_CS_Clear() ;
    isSPITransferDone = false ;
    SPI2_Write((void*)&SSD1306_Initial_Table[0], sizeof(SSD1306_Initial_Table)) ;
    while(isSPITransferDone == false) ;
}

void OLED_SendCmd(uint8_t cmd)
{
    OLED_DC_Clear() ;   // DC=0, command
    OLED_CS_Clear() ;
    isSPITransferDone = false ;
    SPI2_Write(&cmd, 1) ;
    while(isSPITransferDone == false) ;
}

void OLED_SendData(uint8_t data)
{
    OLED_DC_Set() ;   // DC=1, data
    OLED_CS_Clear() ;
    isSPITransferDone = false ;
    SPI2_Write(&data, 1) ;
    while(isSPITransferDone == false) ;    
}

// Set page address for page addressing mode
void OLED_SetPage(uint8_t addr)
{
    // pages are starting from address = 0
    OLED_SendCmd(SSD1306_CMD_SET_PAGE_START_ADDRESS(addr)) ;
}

// Set column address for page addressing mode
void OLED_SetColumn(uint8_t addr)
{
    // columns are starting from address=32 (to 127)
    addr += 32 ;
    // set high column
    OLED_SendCmd((SSD1306_CMD_COL_SET_MSB | (addr>>4))) ;
    // set low column
    OLED_SendCmd((0x0F & addr)) ;
}

uint8_t _x, _y ;

// Clear the screen (96x5 pages = 480 columns)
void OLED_ClearScreen(void)
{
    uint8_t i, j ;
    for (i = 0; i < 5; i++) // 5 pages
    {
        OLED_SetPage(i) ;
        OLED_SetColumn(0) ;
        for (j = 0; j < 96; j++)
        {
            OLED_SendData(0x00) ;
        }
    }
    _x = 0 ;
    _y = 0 ;
    OLED_SetPage(0) ;
    OLED_SetColumn(0) ;
}

// Clear full RAM (128x5 pages = 640 columns)
void OLED_ClearRAM(void)
{
    uint8_t i, j ;
    for (i = 0; i < 5; i++) // 5 pages
    {
        OLED_SetPage(i) ;
        OLED_SetColumn(0) ;
        for (j = 0; j < 128; j++)
        {
            OLED_SendData(0x00) ;
        }
    }
    _x = 0 ;
    _y = 0 ;
    OLED_SetPage(0) ;
    OLED_SetColumn(0) ;   
}

void OLED_SetContrast(uint8_t value)
{
    OLED_SendCmd(SSD1306_CMD_SET_CONTRAST_CONTROL_FOR_BANK0) ;
    OLED_SendCmd(value) ; // contrast step 1 to 256
}

void OLED_InvertDisplay(void)
{
    OLED_SendCmd(SSD1306_CMD_SET_INVERSE_DISPLAY) ;
}

void OLED_NormalDisplay(void)
{
    OLED_SendCmd(SSD1306_CMD_SET_NORMAL_DISPLAY) ;
}

void OLED_PutPicture(const uint8_t *pic)
{
    uint8_t i, j ;
    for(i = 0; i < 0x05; i++)   // 5*4=40 pixel rows (actually 39)
    {
        OLED_SetPage(i) ;
        OLED_SetColumn(0x00) ;
        for(j = 0; j < 96; j++) // 96 pixel columns
        {
            OLED_SendData(*pic++) ;
        }
    }
}

void OLED_Putchar(char c)
{
    uint8_t i ;
    const uint8_t *f = &font[(c - ' ') * 5] ;
    for (i = 0; i < 5; i++)
        OLED_SendData(*f++ << 1) ;
    OLED_SendData(0) ;
    _x++ ;
    if (_x >= 16)
    {   // wrap x
        _x = 0 ;
        OLED_SetColumn(0) ;
        _y++ ;
        if (_y >= 5)
        {   // wrap y
            _y = 0 ;
        }
        OLED_SetPage(_y) ;
    }
}

void OLED_Puts(uint8_t x, uint8_t y, char *s)
{
    _y = y ;
    _x = x ;
    OLED_SetPage(_y) ;
    OLED_SetColumn(_x * 6) ;
    while(*s)
    {
        OLED_Putchar(*s++) ;
    }
}

void OLED_PutInt(uint8_t x, uint8_t y, uint16_t value)
{
    char c[10] ;
    snprintf(c, sizeof(c), "%3d", value) ;
    OLED_Puts(x, y, c) ;
}

void OLED_PutFloat(uint8_t x, uint8_t y, float value)
{
    char c[10] ;
    snprintf(c, sizeof(c), "%.1f", value) ;
    OLED_Puts(x, y, c) ;
}


/*
 * x - column of display, 0 at left to (screen width -1) at right
 * y - row of display, 0 at top to (screen height - 1) at bottom
*/
void OLED_GotoXY(uint8_t x, uint8_t y)
{
    if (x > OLED_SCREEN_X_MAX)
        x = 0 ;
    if (y > OLED_SCREEN_Y_MAX)
        y = 0 ;
    OLED_SetPage(y) ;
    OLED_SetColumn(x) ;
}

void OLED_ScrollRight(uint8_t startPageAddr, uint8_t endPageAddr)
{
    OLED_SendCmd(SSD1306_CMD_SCROLL_H_RIGHT) ;  // 0x26 right horizontal scroll
    OLED_SendCmd(0x00) ;                        // dummy byte
    OLED_SendCmd(startPageAddr) ;               // define start page address
    OLED_SendCmd(0x00) ;                        // set time interval between each scroll
    OLED_SendCmd(endPageAddr) ;                 // define end page address
    OLED_SendCmd(0x00) ;                        // dummy byte
    OLED_SendCmd(0xFF) ;                        // dummy byte
    OLED_SendCmd(SSD1306_CMD_ACTIVATE_SCROLL) ; // activate scroll
}

void OLED_ScrollLeft(uint8_t startPageAddr, uint8_t endPageAddr)
{
    OLED_SendCmd(SSD1306_CMD_SCROLL_H_LEFT) ;   // 0x27 left horizontal scroll
    OLED_SendCmd(0x00) ;                        // dummy byte
    OLED_SendCmd(startPageAddr) ;               // define start page address
    OLED_SendCmd(0x00) ;                        // set time interval between each scroll
    OLED_SendCmd(endPageAddr) ;                 // define end page address
    OLED_SendCmd(0x00) ;                        // dummy byte
    OLED_SendCmd(0xFF) ;                        // dummy byte
    OLED_SendCmd(SSD1306_CMD_ACTIVATE_SCROLL) ; // activate scroll
}

void OLED_ScrollDiagRight(uint8_t startPageAddr, uint8_t endPageAddr)
{
    OLED_SendCmd(SSD1306_CMD_SET_VERTICAL_SCROLL_AREA) ;   // 0xA3 set vertical scroll area
    OLED_SendCmd(0x00) ;                        // set no. of rows in top fixed area
    OLED_SendCmd(39) ;                         // OLED_LCD_HEIGHT - set no. of rows in scroll area
    OLED_SendCmd(SSD1306_CMD_CONTINUOUS_SCROLL_V_AND_H_RIGHT) ; // 0x29 vertical and right horizontal scroll
    OLED_SendCmd(0x00) ;                        // dummy byte
    OLED_SendCmd(startPageAddr) ;               // define start page address
    OLED_SendCmd(0x00) ;                        // set time interval between each scroll
    OLED_SendCmd(endPageAddr) ;                 // define end page address
    OLED_SendCmd(0x01) ;                        // vertical scrolling offset
    OLED_SendCmd(SSD1306_CMD_ACTIVATE_SCROLL) ; // activate scroll
}

void OLED_ScrollDiagLeft(uint8_t startPageAddr, uint8_t endPageAddr)
{
    OLED_SendCmd(SSD1306_CMD_SET_VERTICAL_SCROLL_AREA) ;   // 0xA3 set vertical scroll area
    OLED_SendCmd(0x00) ;                        // set no. of rows in top fixed area
    OLED_SendCmd(39) ;                         // OLED_LCD_HEIGHT - set no. of rows in scroll area
    OLED_SendCmd(SSD1306_CMD_CONTINUOUS_SCROLL_V_AND_H_LEFT) ; // 0x2A vertical and right horizontal scroll
    OLED_SendCmd(0x00) ;                        // dummy byte
    OLED_SendCmd(startPageAddr) ;               // define start page address
    OLED_SendCmd(0x00) ;                        // set time interval between each scroll
    OLED_SendCmd(endPageAddr) ;                 // define end page address
    OLED_SendCmd(0x01) ;                        // vertical scrolling offset
    OLED_SendCmd(SSD1306_CMD_ACTIVATE_SCROLL) ; // activate scroll
}

void OLED_StopScroll(void)
{
    OLED_SendCmd(SSD1306_CMD_DEACTIVATE_SCROLL) ;
}

void OLED_DrawCircle(uint8_t x, uint8_t y)
{
    OLED_GotoXY(x, y) ;
    OLED_SendData(0xC0) ;
    OLED_SendData(0x30) ;
    OLED_SendData(0x08) ;
    OLED_SendData(0x04) ;
    OLED_SendData(0x04) ;
    OLED_SendData(0x02) ;
    OLED_SendData(0x02) ;
    OLED_SendData(0x02) ;
    OLED_SendData(0x02) ;
    OLED_SendData(0x02) ;
    OLED_SendData(0x04) ;
    OLED_SendData(0x04) ;
    OLED_SendData(0x08) ;
    OLED_SendData(0x30) ;
    OLED_SendData(0xC0) ;
    OLED_GotoXY(x, y+1) ;
    OLED_SendData(0x07) ;
    OLED_SendData(0x18) ;
    OLED_SendData(0x20) ;
    OLED_SendData(0x40) ;
    OLED_SendData(0x40) ;
    OLED_SendData(0x80) ;
    OLED_SendData(0x80) ;
    OLED_SendData(0x80) ;
    OLED_SendData(0x80) ;
    OLED_SendData(0x80) ;
    OLED_SendData(0x40) ;
    OLED_SendData(0x40) ;
    OLED_SendData(0x20) ;
    OLED_SendData(0x18) ;
    OLED_SendData(0x07) ;
}

void OLED_DrawFilledCircle(uint8_t x, uint8_t y)
{
    OLED_GotoXY(x, y) ;
    OLED_SendData(0xC0) ;
    OLED_SendData(0xF0) ;
    OLED_SendData(0xF8) ;
    OLED_SendData(0xFC) ;
    OLED_SendData(0xFC) ;
    OLED_SendData(0xFE) ;
    OLED_SendData(0xFE) ;
    OLED_SendData(0xFE) ;
    OLED_SendData(0xFE) ;
    OLED_SendData(0xFE) ;
    OLED_SendData(0xFC) ;
    OLED_SendData(0xFC) ;
    OLED_SendData(0xF8) ;
    OLED_SendData(0xF0) ;
    OLED_SendData(0xC0) ;
    OLED_GotoXY(x, y+1) ;
    OLED_SendData(0x07) ;
    OLED_SendData(0x1F) ;
    OLED_SendData(0x3F) ;
    OLED_SendData(0x7F) ;
    OLED_SendData(0x7F) ;
    OLED_SendData(0xFF) ;
    OLED_SendData(0xFF) ;
    OLED_SendData(0xFF) ;
    OLED_SendData(0xFF) ;
    OLED_SendData(0xFF) ;
    OLED_SendData(0x7F) ;
    OLED_SendData(0x7F) ;
    OLED_SendData(0x3F) ;
    OLED_SendData(0x1F) ;
    OLED_SendData(0x07) ;
}

// progress bar
void OLED_DrawRectangle(uint8_t x, uint8_t y)
{
    uint8_t i ;
    OLED_GotoXY(x, y) ;
    OLED_SendData(0xFF) ;
    for (i = 0; i < 67; i++)
        OLED_SendData(0x01) ;
    OLED_SendData(0xFF) ;
    OLED_GotoXY(x, y+1) ;
    OLED_SendData(0xFF) ;
    for (i = 0; i < 67; i++)
        OLED_SendData(0x80) ;
    OLED_SendData(0xFF) ;
}

// cursor in the progress bar
void OLED_DrawCursor(uint8_t x, uint8_t y)
{
    uint8_t i ;
    OLED_GotoXY(x, y) ;
    for (i = 0; i < CURSOR_WIDTH; i++)
        OLED_SendData(0xFF) ;
    OLED_GotoXY(x, y+1) ;    
    for (i = 0; i < CURSOR_WIDTH; i++)
        OLED_SendData(0xFF) ;
}


void OLED_SplashScreen(void)
{
    OLED_ClearRAM() ;
    OLED_PutPicture((uint8_t*)&microchip_logo[0]) ;
    OLED_Puts(5, 3, "WFI32E01") ;
}

void OLED_MainScreen(void)
{
    OLED_ClearRAM() ;
    OLED_Puts(4, 0, "*WiFi Touch*") ;
    OLED_Puts(0, 1, "1") ;
    OLED_Puts(0, 4, "2") ;        
    OLED_DrawCircle(6, 0) ;
    OLED_DrawCircle(6, 3) ;
    
    OLED_PutInt(8, 2, 0) ;
    //OLED_PutFloat(8, 2, 127.2) ;
    
    OLED_DrawRectangle(RECTANGLE_POS_X, 3) ;
    OLED_DrawCursor(CURSOR_MIN_POS, 3) ;

/*    uint8_t i, j ;
    for (i = 0; i < CURSOR_STEPS; i++)
    {
        for (j = 0; j < 20; j++)
            OLED_Delay() ;
        OLED_DrawRectangle(RECTANGLE_POS_X, 3) ;
        OLED_DrawCursor(CURSOR_MIN_POS + i, 3) ;
    }
    for (i = 0; i < CURSOR_STEPS; i++)
    {
        for (j = 0; j < 20; j++)
            OLED_Delay() ;
        OLED_DrawRectangle(RECTANGLE_POS_X, 3) ;
        OLED_DrawCursor(CURSOR_MAX_POS - i, 3) ;
    }
 */
}

/*******************************************************************************
 End of File
 */
